# AI Trading Backend V8 配置示例
# 复制此文件为 .env 并填入实际配置

# ==================== 应用配置 ====================
APP_NAME="AI Trading Risk & Auto-Hedge System"

# 交易模式：OFF（关闭）/ DRY_RUN（模拟）/ REAL（实盘）
# 建议先使用 DRY_RUN 测试
TRADE_MODE=REAL

# ==================== 数据库与缓存配置 ====================
# 数据库类型: sqlite / mysql
# 注意：切换为 mysql 前请确保数据库已创建且用户有权限
DB_TYPE=mysql

# SQLite 配置（当 DB_TYPE=sqlite 时有效）
SQLITE_DB_PATH=./demo.db

# MySQL 配置（当 DB_TYPE=mysql 时有效）
MYSQL_HOST=127.0.0.1
MYSQL_PORT=3306
MYSQL_USER=ai_trading
# 请在实际部署中不要在 .env.example 中写入真实密码
MYSQL_PASSWORD=your_mysql_password_here
MYSQL_DB=ai_trading

# Redis 配置
REDIS_HOST=127.0.0.1
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# ==================== Tiger 券商配置 ====================
# Tiger 账户号（模拟盘或真实账户）
# 示例：21272246230273657
TIGER_ACCOUNT=

# Tiger Open API 配置（使用官方 tigeropen SDK）
# 留空则使用 Dummy 客户端（测试模式，Greeks 和持仓均为 0）

# RSA 私钥文件路径（.pem 格式）
# 生成方法：openssl genrsa -out private_key.pem 1024
TIGER_PRIVATE_KEY_PATH=backend/keys/private_key.pem

# 开发者 ID（从老虎开放平台获取）
# 获取地址：https://quant.itigerup.com/openapi/
TIGER_ID=

# 行情数据模式配置
# DELAYED: 免费延迟行情（约15-20分钟延迟）- 适合开发测试
# REALTIME: 实时行情（需付费订阅）- 生产环境必须
# 详细说明见：QUOTE_DATA_ANALYSIS.md
TIGER_QUOTE_MODE=REALTIME

# 是否在 API 响应中显示数据延迟警告
QUOTE_DATA_WARNING=true

# ==================== OpenAI 配置 ====================
# 用于 AI 决策助手（模型名以你的账号可用列表为准，服务端会做回退）
# 请不要在示例文件中放置真实密钥
OPENAI_API_KEY=
OPENAI_MODEL=gpt-5.2
OPENAI_MAX_TOKENS=4096
OPENAI_TIMEOUT_SECONDS=30
OPENAI_API_BASE=

# ==================== DeepSeek 配置（AI 兜底方案） ====================
# DeepSeek API 完全兼容 OpenAI 格式，在 OpenAI 失败时自动切换
DEEPSEEK_API_KEY=
DEEPSEEK_API_BASE=https://api.deepseek.com/v1
DEEPSEEK_ENABLED=true
DEEPSEEK_MODEL=deepseek-reasoner
DEEPSEEK_TIMEOUT_SECONDS=120

# ==================== AI 策略配置 ====================
# 可用的 AI 提供商列表，按优先级排序（逗号分隔）
AI_PROVIDERS=openai,deepseek
# 优先使用的 AI 提供商
AI_PREFERRED_PROVIDER=deepseek

# ===== FRED API (Federal Reserve Economic Data) ======
# 用途: 获取宏观经济指标数据
FRED_API_KEY=

# ===== 数据缓存配置 =====
# 技术指标缓存时长（小时）
CACHE_TTL_TECHNICAL_HOURS=1
# 基本面数据缓存时长（小时）
CACHE_TTL_FUNDAMENTAL_HOURS=24
# 宏观指标缓存时长（小时）
CACHE_TTL_MACRO_HOURS=24
# 地缘政治事件缓存时长（小时）
CACHE_TTL_GEOPOLITICAL_HOURS=24

# ===== 定时任务配置 =====
# 是否启用定时任务
ENABLE_SCHEDULER=true
SCHEDULER_TECHNICAL_HOURS=1
SCHEDULER_FUNDAMENTAL_HOURS=24
SCHEDULER_MACRO_HOURS=24
SCHEDULER_GEOPOLITICAL_HOURS=24
SCHEDULER_RISK_HOURS=24

# ==================== 网络代理配置（可选） ====================
# 通过配置管理代理开关：启用后,服务启动时会设置 HTTP(S)_PROXY/NO_PROXY 环境变量，
# OpenAI（httpx）与 FRED（requests/fredapi）都会自动走代理。
PROXY_ENABLED=true
HTTP_PROXY=http://127.0.0.1:7897
HTTPS_PROXY=http://127.0.0.1:7897
NO_PROXY=localhost,127.0.0.1,quant.itigerup.com,api.deepseek.com

# ==================== 并发控制配置（中期优化） ====================
# 外部API并发上限（Tiger/FRED/News/Yahoo等）
EXTERNAL_API_CONCURRENCY=5
# 刷新任务并发上限（positions/refresh 等）
REFRESH_CONCURRENCY=5

# ==================== 风险预算配置 ====================
DEFAULT_RISK_BUDGET_USD=20000

# ==================== 外部 API 限流规避 ====================
# 触发限流后冷却时间（秒）
API_RATE_LIMIT_COOLDOWN_SECONDS=900

# ==================== 认证配置（默认启用） ====================
# 是否开启认证（默认 True）。在生产环境请通过环境变量覆盖默认用户名/密码。
AUTH_ENABLED=True
ADMIN_USERNAME=admin
ADMIN_PASSWORD=admin
# 用于签发 JWT token 的密钥，请在部署时设置为强随机值
JWT_SECRET_KEY=
ACCESS_TOKEN_EXPIRE_MINUTES=60

# 新闻/数据 API Key（示例占位符）
NEWS_API_KEY=

# ==================== 线上部署配置 (Traefik / SSL) ====================
# 用于 Traefik SSL 证书申请的邮箱
ACME_EMAIL=your-email@example.com
# 服务的域名配置
FRONTEND_DOMAIN=localhost:5173
BACKEND_DOMAIN=localhost:8088

# ==================== 配置说明 ====================
# 
# 1. Tiger Open API 配置步骤：
#    - 访问：https://quant.itigerup.com
#    - 注册并创建应用
#    - 生成 RSA 密钥对
#    - 上传公钥到平台
#    - 获取 tiger_id
#    - 将私钥路径和 tiger_id 填入上方
#
# 2. 交易模式说明：
#    - OFF：系统运行但不生成任何订单
#    - DRY_RUN：生成订单但仅打印，不实际发送（推荐测试用）
#    - REAL：真实下单到券商（谨慎使用！）
#
# 3. 使用 Dummy 客户端测试：
#    - 如果不配置 TIGER_PRIVATE_KEY_PATH 和 TIGER_ID
#    - 系统会使用模拟客户端，返回空持仓和 0 Greeks
#    - 适合开发和功能测试

# ==================== 风险预算配置 ====================
DEFAULT_RISK_BUDGET_USD=20000

# ==================== 并发控制配置（中期优化） ====================
# 外部API并发上限（Tiger/FRED/News/Yahoo等）
EXTERNAL_API_CONCURRENCY=5

# 刷新任务并发上限（positions/refresh 等）
REFRESH_CONCURRENCY=5

# ==================== 外部 API 限流规避 ====================
# 触发限流后冷却时间（秒）
API_RATE_LIMIT_COOLDOWN_SECONDS=900


# ==================== 认证配置（默认启用） ====================
# 是否开启认证（默认 True）。在生产环境请通过环境变量覆盖默认用户名/密码。
AUTH_ENABLED=True
ADMIN_USERNAME=admin
ADMIN_PASSWORD=admin
# 用于签发 JWT token 的密钥，请在部署时设置为强随机值
JWT_SECRET_KEY=change-me-please
ACCESS_TOKEN_EXPIRE_MINUTES=60
# ==================== 线上部署配置 (Traefik / SSL) ====================
# 用于 Traefik SSL 证书申请的邮箱
ACME_EMAIL=your-email@example.com

# 服务的域名配置
FRONTEND_DOMAIN=ai-trading.example.com
BACKEND_DOMAIN=api.ai-trading.example.com


# ==================== DeepSeek 配置（AI 兜底方案） ====================
# DeepSeek API 完全兼容 OpenAI 格式，在 OpenAI 失败时自动切换
# 申请地址：https://platform.deepseek.com/api_keys
DEEPSEEK_API_BASE=https://api.deepseek.com/v1
DEEPSEEK_API_KEY=your-deepseek-api-key-here
DEEPSEEK_ENABLED=true
DEEPSEEK_MODEL=deepseek-reasoner
# 可选模型：deepseek-chat（非思考模式），deepseek-reasoner（思考模式）

# ==================== AI 策略配置 ====================
# 可用的 AI 提供商列表，按优先级排序（逗号分隔）
AI_PROVIDERS=openai,deepseek
# 优先使用的 AI 提供商
AI_PREFERRED_PROVIDER=deepseek