# 产品概览（后端视角）

AI Trading Backend V8 由四个相对独立的能力簇组成：

1) **风险管理与自动对冲**（Greeks 暴露、限额、自动生成对冲方案）
2) **行为画像与行为评分**（从历史成交/盈亏抽取“卖飞、过度交易、报复性交易”等）
3) **持仓评估**（技术面 + 基本面 + 情绪/风险合成，输出建议与关键价位）
4) **宏观风险与机会扫描**（宏观风险概览 + Opportunities 每日扫描）
5) **交易计划**（计划创建/更新/执行状态）

## 关键产品约束（必须写进文档的“口径”）

- **宏观分析与短期趋势不联动**：宏观风险模块独立输出，不直接参与日线趋势判断。
- **趋势快照持久化**：日线走势分析会写入 `position_trend_snapshots`（每日每标的留最新快照），供持仓评估接口直接读取。
- **不输出“趋势信心/可信度”数值**：日线走势结论强调交易员风格与可执行条件触发，不返回趋势置信度字段。

## 持仓评估（Positions Assessment）

- 输入：账户持仓（来自 Tiger 或 Dummy）
- 计算：
  - 技术分析（含趋势/RSI/MACD/布林/支撑阻力/量比）
  - 基本面分析
  - 合成评分与建议
- 输出：`GET /api/v1/positions/assessment` 返回每个标的的评分、建议与 `trend_snapshot`，并包含 `budget_utilization` / `plan_deviation`。

## 宏观风险（Macro Risk）

- 输出：`GET /api/v1/macro/risk/overview` 返回综合风险、分项风险、预警、建议、AI 解读（可降级）。
- 刷新：`POST /api/v1/macro/refresh`

## Opportunities（潜在机会）

- 输出：`GET /api/v1/opportunities/latest` 获取最新一次扫描结果（含计划匹配标签）
- 触发：`POST /api/v1/opportunities/scan` 支持即时扫描与可选更新 cron

## 执行列表 + 策略管理扩展

- **执行列表为交易员提供核心的操作中心**：它负责将各类信号、策略和执行指令组合起来，可自动同步账户数据并推送到下游执行引擎。
- **策略管理则是执行列表的“智能大脑”**：所有可执行的中短期交易逻辑都从这里过渡，包括平台预置与用户自定义策略。

### 策略管理模块

- **内置华尔街私募精选策略**：复刻多个中短期精选标的策略，如“事件驱动趋势发现”、“日内切换突破”、“量化动量轮动”等，目标是帮助交易员快速找到符合私募风格的高质量创意。
- **内置华尔街私募精选策略**：复刻多个中短期精选标的策略，如“事件驱动趋势发现”、“日内切换突破”、“量化动量轮动”等，目标是帮助交易员快速找到符合私募风格的高质量创意。
  - `事件驱动趋势发现`：依托 15 分钟突破 + 财报/宏观事件过滤，捕捉快速 alpha。
  - `日内切换突破`：结合 5-30 分钟结构与成交量波动，实现“切换行情”场景的短线进出。
  - `量化动量轮动`：使用 30-60 天动量与基本面因子，轮动持仓池并限制整体 beta。
- **策略参数化与规则透明**：每个策略都能显示信号维度（技术/情绪/基本面等），支持实时调参（比如周期、阈值、资金比例）并记录变更以便复盘。
- **支持自定义策略**：用户可以在策略管理里定义指标模板、策略步骤、风控触发条件，配合内置 execution plan 生成可复用的执行策略包。自定义策略可保存为模板并分享给团队。

### 在执行列表中调用策略

- **策略下拉选择器**：执行列表内新增“策略管理”入口，列出可用的内置/自定义策略，交易员可筛选（行业、时效、风格）、预览或直接创建执行计划。
- **策略运行**：当交易员选择策略后，再选择目标账户与预算，可立即触发策略运行。运行过程采用异步机制（后台任务），使执行界面保持响应，并通过状态栏实时更新对应 pipeline 进度。
- **最近一次运行焦点区**：执行列表核心区域新增“最近一次策略运行”卡片，展示最近执行的策略名、命中标的、命中理由摘要、信号强度评分与风险提示，帮助交易员快速判断是否执行。

### 历史扫描记录

- 所有策略运行都会在 `historical_strategy_runs` 中创建记录，包含运行时间、策略版本、输入条件、命中标的、命中率、耗时、异步状态（排队/执行/完成/失败）等。
- **历史扫描记录页**（可在执行列表旁边 Tab 云或独立页）可以按照策略、账户、时间段查询。列表支持导出 CSV 并触发复盘报告。
- **指标汇总与通知**：历史记录支持聚合最近 N 次运行的成功率，自动生成异步通知（如钉钉/Slack）并推送给相关交易员。

通过上述扩展，执行列表不仅是“指令中心”，更成为“策略实验室”，让私募级策略管理和中短期交易标的发现在一个页面内完成。
